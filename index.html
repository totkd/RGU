<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>配送エリア調整ツール</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Google+Sans+Code:wght@400;500;700&family=IBM+Plex+Sans+JP:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="layout">
      <aside class="panel">
        <h1>配送エリア調整</h1>
        <p class="lead">行政区画ポリゴンを選択して担当デポを割り当てます。</p>

        <section class="card">
          <h2>1. データ読込</h2>
          <label class="field">
            <span>行政区画 GeoJSON</span>
            <input id="geojson-input" type="file" accept=".geojson,.json,application/geo+json,application/json" />
          </label>
          <p class="small">運用では asis 反映済み GeoJSON を読み込んで編集してください。</p>
        </section>

        <section class="card">
          <h2>2. 選択条件</h2>
          <label class="field">
            <span>自治体フィルタ</span>
            <select id="municipality-filter">
              <option value="">すべて</option>
            </select>
          </label>
          <label class="field">
            <span>エリアID/名称ジャンプ</span>
            <input id="zip-search" type="text" maxlength="48" placeholder="例: 14113 / 横浜市緑区" />
          </label>
          <div class="row">
            <button id="jump-zip" type="button">地図で表示</button>
            <button id="clear-selection" type="button" class="ghost">選択解除</button>
          </div>
        </section>

        <section class="card">
          <h2>3. デポ割当</h2>
          <p id="selected-count">選択中: 0件</p>
          <div class="depot-actions">
            <button class="depot-btn depot-sgm" type="button" data-depot="SGM">相模原デポ SGM</button>
            <button class="depot-btn depot-fuj" type="button" data-depot="FUJ">藤沢デポ FUJ</button>
            <button class="depot-btn depot-yok" type="button" data-depot="YOK">横浜港北デポ YOK</button>
            <button id="clear-assignment" type="button" class="ghost">割当クリア</button>
          </div>
        </section>

        <section class="card">
          <h2>4. 出力</h2>
          <button id="export-csv" type="button">CSV出力</button>
          <p class="small">出力列: <code>area_id,area_name,municipality,depot_code,depot_name</code></p>
        </section>

        <section class="card">
          <h2>集計</h2>
          <ul id="stats" class="stats"></ul>
        </section>

        <section class="card">
          <h2>選択中エリア</h2>
          <div id="selected-zips" class="chips"></div>
        </section>
      </aside>

      <section class="map-wrap">
        <div id="map"></div>
        <div class="legend">
          <span><i class="dot sgm"></i>相模原デポ</span>
          <span><i class="dot fuj"></i>藤沢デポ</span>
          <span><i class="dot yok"></i>横浜港北デポ</span>
          <span><i class="dot none"></i>未割当</span>
        </div>
      </section>
    </main>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <script src="./app.js"></script>
  </body>
</html>
