<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AreaKit</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=LINE+Seed+JP:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/@primer/css@21.5.1/dist/primer.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="layout" id="layout">
      <aside class="panel" id="sidebar">
        <div class="brand-row">
          <h1>AreaKit</h1>
          <a class="repo-link" href="https://github.com/totkd/AreaKit" target="_blank" rel="noopener noreferrer" aria-label="Open GitHub repository">
            <svg class="repo-link-icon" viewBox="0 0 16 16" width="14" height="14" aria-hidden="true">
              <path d="M8 0C3.58 0 0 3.58 0 8a8 8 0 0 0 5.47 7.59c.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.5-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.65 7.65 0 0 1 4 0c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8Z"></path>
            </svg>
            <span class="repo-link-label">Github</span>
          </a>
        </div>
        <a class="lead lead-link" href="https://www.gion-deliveryservice.co.jp/" target="_blank" rel="noopener noreferrer">
          2026 GION DELIVERY SERVICE KK.
        </a>

        <section class="card">
          <div class="section-header">
            <h2>Map Tiles</h2>
            <span class="info-tip" aria-hidden="true">
              <svg class="octicon ui-icon" viewBox="0 0 16 16" width="14" height="14">
                <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-4.25a1 1 0 1 0 0 2 1 1 0 0 0 0-2ZM8 6.5a.75.75 0 0 0-.75.75v3.5a.75.75 0 0 0 1.5 0v-3.5A.75.75 0 0 0 8 6.5Z"></path>
              </svg>
              <span class="tip-bubble">背景の地図を変更します</span>
            </span>
          </div>
          <fieldset id="basemap-options" class="radio-group">
            <label><input type="radio" name="basemap" value="esri_street" checked /> Esri ワールドストリート</label>
            <label><input type="radio" name="basemap" value="gsi_std" /> 地理院 標準（日本語）</label>
            <label><input type="radio" name="basemap" value="gsi_pale" /> 地理院 淡色</label>
            <label><input type="radio" name="basemap" value="gsi_blank" /> 地理院 白地図</label>
            <label><input type="radio" name="basemap" value="gsi_seamless" /> 地理院 シームレス写真</label>
            <label><input type="radio" name="basemap" value="osm" /> オープンストリートマップ</label>
            <label><input type="radio" name="basemap" value="osm_hot" /> OSM Humanitarian</label>
            <label><input type="radio" name="basemap" value="carto" /> CARTO ボイジャー</label>
            <label><input type="radio" name="basemap" value="carto_light" /> CARTO ポジトロン</label>
          </fieldset>
        </section>

        <section class="card">
          <div class="section-header">
            <h2>Polygon Visibility</h2>
            <span class="info-tip" aria-hidden="true">
              <svg class="octicon ui-icon" viewBox="0 0 16 16" width="14" height="14">
                <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-4.25a1 1 0 1 0 0 2 1 1 0 0 0 0-2ZM8 6.5a.75.75 0 0 0-.75.75v3.5a.75.75 0 0 0 1.5 0v-3.5A.75.75 0 0 0 8 6.5Z"></path>
              </svg>
              <span class="tip-bubble">町域ボーダーを表示する都県を選択します</span>
            </span>
          </div>
          <fieldset id="prefecture-visibility" class="checkbox-group">
            <label><input type="checkbox" name="prefecture-visibility" value="神奈川県" checked /> 神奈川県</label>
            <label><input type="checkbox" name="prefecture-visibility" value="東京都" checked /> 東京都</label>
            <label><input type="checkbox" name="prefecture-visibility" value="千葉県" /> 千葉県</label>
            <label><input type="checkbox" name="prefecture-visibility" value="埼玉県" /> 埼玉県</label>
          </fieldset>
        </section>

        <section class="card">
          <div class="section-header">
            <h2>Borderline Settings</h2>
            <span class="info-tip" aria-hidden="true">
              <svg class="octicon ui-icon" viewBox="0 0 16 16" width="14" height="14">
                <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-4.25a1 1 0 1 0 0 2 1 1 0 0 0 0-2ZM8 6.5a.75.75 0 0 0-.75.75v3.5a.75.75 0 0 0 1.5 0v-3.5A.75.75 0 0 0 8 6.5Z"></path>
              </svg>
              <span class="tip-bubble">境界線の太さや種類、塗り色を変更できます</span>
            </span>
          </div>
          <div class="settings-grid">
            <div class="settings-row">
              <label class="settings-label" for="border-preset">Preset</label>
              <select id="border-preset" class="settings-select">
                <option value="default">Default</option>
                <option value="thin">Thin</option>
                <option value="bold">Bold</option>
                <option value="high-contrast">High Contrast</option>
              </select>
            </div>

            <details id="settings-shiku" class="settings-accordion">
              <summary class="boundary-summary">
                <span class="boundary-summary-label">Shiku Boundary</span>
                <span class="boundary-summary-tip">市区町村の境界線</span>
              </summary>
              <div class="settings-row">
                <label class="settings-label" for="shiku-width">Width</label>
                <div class="settings-control">
                  <input id="shiku-width" type="range" min="0.2" max="6.0" step="0.1" />
                  <span id="shiku-width-value" class="settings-value">2.9</span>
                </div>
              </div>
              <div class="settings-row">
                <label class="settings-label" for="shiku-opacity">Opacity</label>
                <div class="settings-control">
                  <input id="shiku-opacity" type="range" min="0" max="1" step="0.01" />
                  <span id="shiku-opacity-value" class="settings-value">0.86</span>
                </div>
              </div>
              <div class="settings-row">
                <label class="settings-label" for="shiku-color">Color</label>
                <input id="shiku-color" type="color" />
              </div>
            </details>

            <details id="settings-block" class="settings-accordion">
              <summary class="boundary-summary">
                <span class="boundary-summary-label">Block Boundary</span>
                <span class="boundary-summary-tip">町域ブロックの境界線</span>
              </summary>
              <div class="settings-row">
                <label class="settings-label" for="block-width">Width</label>
                <div class="settings-control">
                  <input id="block-width" type="range" min="0.2" max="3.0" step="0.1" />
                  <span id="block-width-value" class="settings-value">1.0</span>
                </div>
              </div>
              <div class="settings-row">
                <label class="settings-label" for="block-opacity">Opacity</label>
                <div class="settings-control">
                  <input id="block-opacity" type="range" min="0" max="1" step="0.01" />
                  <span id="block-opacity-value" class="settings-value">0.86</span>
                </div>
              </div>
              <div class="settings-row">
                <label class="settings-label" for="block-style">Style</label>
                <select id="block-style" class="settings-select">
                  <option value="solid">Solid</option>
                  <option value="dashed">Dashed</option>
                  <option value="dotted">Dotted</option>
                </select>
              </div>
              <div class="settings-row">
                <label class="settings-label" for="block-color">Color</label>
                <input id="block-color" type="color" />
              </div>
            </details>

            <div class="settings-row">
              <label class="settings-label" for="fill-inscope">In-scope Fill</label>
              <div class="settings-control">
                <input id="fill-inscope" type="range" min="0" max="3" step="0.01" />
                <span id="fill-inscope-value" class="settings-value">1.00</span>
              </div>
            </div>
          </div>
        </section>

        <section class="card">
          <div class="section-header">
            <h2>Zone Select</h2>
            <span class="info-tip" aria-hidden="true">
              <svg class="octicon ui-icon" viewBox="0 0 16 16" width="14" height="14">
                <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-4.25a1 1 0 1 0 0 2 1 1 0 0 0 0-2ZM8 6.5a.75.75 0 0 0-.75.75v3.5a.75.75 0 0 0 1.5 0v-3.5A.75.75 0 0 0 8 6.5Z"></path>
              </svg>
              <span class="tip-bubble">選択したゾーンに対する操作を選んでください<br />All Resetをクリックすると初期状態に戻り、元に戻せません</span>
            </span>
          </div>
          <p id="selected-count">Selected: 0</p>
          <p class="section-tag">Allocate</p>
          <div class="depot-actions">
            <button class="depot-btn depot-sgm" type="button" data-depot="SGM">SGM</button>
            <button class="depot-btn depot-fuj" type="button" data-depot="FUJ">FUJ</button>
            <button class="depot-btn depot-yok" type="button" data-depot="YOK">YOK</button>
          </div>
          <div class="row history-row">
            <button id="undo-action" type="button" class="ghost">← Undo</button>
            <button id="redo-action" type="button" class="ghost">Redo →</button>
          </div>
          <button id="reset-all" type="button" class="ghost danger">All Reset</button>
        </section>

        <section class="card">
          <h2>
            <svg class="octicon ui-icon" viewBox="0 0 16 16" width="14" height="14" aria-hidden="true">
              <path d="M7.47 10.78a.75.75 0 0 0 1.06 0l3-3a.75.75 0 1 0-1.06-1.06L8.75 8.44V1.75a.75.75 0 0 0-1.5 0v6.69L5.53 6.72a.75.75 0 0 0-1.06 1.06l3 3Z"></path>
              <path d="M2.5 10.75a.75.75 0 0 0-1.5 0v2A2.25 2.25 0 0 0 3.25 15h9.5A2.25 2.25 0 0 0 15 12.75v-2a.75.75 0 0 0-1.5 0v2a.75.75 0 0 1-.75.75h-9.5a.75.75 0 0 1-.75-.75v-2Z"></path>
            </svg>
            Export
          </h2>
          <button id="export-csv" type="button">Download CSV</button>
        </section>

        <section class="card">
          <h2>Selected Zones</h2>
          <div id="selected-zips" class="chips"></div>
        </section>
      </aside>

      <section class="map-wrap">
        <button id="panel-toggle" type="button" class="panel-toggle" aria-expanded="true" aria-label="Hide Sidebar">
          <svg class="panel-toggle-icon panel-toggle-icon-expanded" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true">
            <path d="M9.78 12.53a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 0-1.06l4-4a.75.75 0 1 1 1.06 1.06L6.31 8l3.47 3.47a.75.75 0 0 1 0 1.06Z"></path>
          </svg>
          <svg class="panel-toggle-icon panel-toggle-icon-collapsed" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true">
            <path d="M6.22 12.53a.75.75 0 0 0 1.06 0l4-4a.75.75 0 0 0 0-1.06l-4-4a.75.75 0 1 0-1.06 1.06L9.69 8l-3.47 3.47a.75.75 0 0 0 0 1.06Z"></path>
          </svg>
        </button>
        <button id="panel-backdrop" type="button" class="panel-backdrop" aria-label="Close Sidebar"></button>
        <div id="map"></div>
        <div id="loading-overlay" class="loading-overlay" aria-live="polite" aria-atomic="true">
          <div id="loading-card" class="loading-card" role="status">
            <p id="loading-title" class="loading-title">Loading...</p>
            <p id="loading-step-tiles" class="loading-step is-pending">Map Tilesを読み込んでいます...</p>
            <p id="loading-step-polygons" class="loading-step is-pending">東京都と神奈川県の町域ポリゴンを読み込んでいます...</p>
          </div>
        </div>
        <div class="legend">
          <span><i class="dot sgm"></i>SGM</span>
          <span><i class="dot fuj"></i>FUJ</span>
          <span><i class="dot yok"></i>YOK</span>
          <span><i class="dot none"></i>Unassigned</span>
        </div>
      </section>
    </main>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <script type="module" src="./app.js"></script>
  </body>
</html>
